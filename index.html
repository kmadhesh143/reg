
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>UPI QR Generator & Share</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body {
  font-family: Arial, sans-serif;
  text-align: center;
  padding: 20px;
}
input {
  width: 90%;
  padding: 12px;
  font-size: 16px;
  margin-bottom: 10px;
}
button {
  padding: 12px 20px;
  font-size: 16px;
  background: #0a7cff;
  color: #fff;
  border: none;
  border-radius: 6px;
  margin-top: 10px;
  cursor: pointer;
}
canvas {
  margin-top: 15px;
  max-width: 100%;
  border-radius: 10px;
  border: 1px solid #ddd;
  display: none;
}
#shareBtn {
  display: none;
}
</style>

<!-- QRCode.js library -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>

</head>
<body>

<h2>UPI QR Generator & Share</h2>

<input type="text" id="amount" placeholder="Enter Amount (₹)">
<br>
<button onclick="generateQR()">Generate QR</button>

<br>
<canvas id="canvas" width="600" height="800"></canvas>
<br>
<button id="shareBtn" onclick="shareImage()">Share Image</button>

<script>
const canvas = document.getElementById("canvas");
const ctx = canvas.getContext("2d");
const shareBtn = document.getElementById("shareBtn");
const UPI_ID = "nithin0832@oksbi"; // <-- Replace with your UPI ID

function generateQR() {
  const amount = document.getElementById("amount").value.trim();
  if (!amount) {
    alert("Please enter an amount");
    return;
  }

  const upiURL = `upi://pay?pa=${encodeURIComponent(UPI_ID)}&pn=Payment&am=${amount}&cu=INR`;

  // Temporary div to generate QR code as canvas
  const tempDiv = document.createElement("div");
  const qr = new QRCode(tempDiv, {
    text: upiURL,
    width: 300,
    height: 300,
    correctLevel: QRCode.CorrectLevel.H
  });

  // QRCode.js generates a <canvas> inside tempDiv
  const qrCanvas = tempDiv.querySelector("canvas");
  if (!qrCanvas) {
    alert("QR generation failed");
    return;
  }

  // Wait a short time to ensure QR is rendered
  setTimeout(() => {
    // Show main canvas and share button
    canvas.style.display = "block";
    shareBtn.style.display = "inline-block";

    // Clear main canvas
    ctx.fillStyle = "#fff";
    ctx.fillRect(0, 0, canvas.width, canvas.height);

    // Title
    ctx.fillStyle = "#000";
    ctx.font = "bold 36px Arial";
    ctx.textAlign = "center";
    ctx.fillText("PAYMENT QR", canvas.width / 2, 100);

    // Amount
    ctx.font = "bold 48px Arial";
    ctx.fillStyle = "#0a7cff";
    ctx.fillText("₹ " + amount, canvas.width / 2, 200);

    // Draw QR from generated QR canvas
    ctx.drawImage(qrCanvas, 150, 260, 300, 300);

    // Text below QR
    ctx.font = "20px Arial";
    ctx.fillStyle = "#555";
    ctx.fillText("Scan using any UPI App", canvas.width / 2, 620);

    // Scroll to share button
    shareBtn.scrollIntoView({ behavior: "smooth" });
  }, 50); // short delay to ensure QR is drawn
}

async function shareImage() {
  canvas.toBlob(async (blob) => {
    const file = new File([blob], "upi-payment.png", { type: "image/png" });

    if (navigator.canShare && navigator.canShare({ files: [file] })) {
      await navigator.share({
        files: [file],
        title: "UPI Payment QR",
        text: "Scan & Pay"
      });
    } else {
      alert("Sharing not supported on this device");
    }
  });
}
</script>

<p>Thanks for watching!</p>

</body>
</html>
